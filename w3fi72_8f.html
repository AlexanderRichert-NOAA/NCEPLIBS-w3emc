<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-w3emc: w3fi72.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-w3emc
   &#160;<span id="projectnumber">2.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('w3fi72_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3fi72.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="w3fi72_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aaac6e022f341c919316466672ef3e70c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="w3fi72_8f.html#aaac6e022f341c919316466672ef3e70c">w3fi72</a> (ITYPE, FLD, IFLD, IBITL, IPFLAG, ID, PDS, IGFLAG, IGRID, IGDS, ICOMP, IBFLAG, IBMAP, IBLEN, IBDSFL, NPTS, KBUF, ITOT, JERR)</td></tr>
<tr class="memdesc:aaac6e022f341c919316466672ef3e70c"><td class="mdescLeft">&#160;</td><td class="mdescRight">SUBPROGRAM: W3FI72 MAKE A COMPLETE GRIB MESSAGE PRGMMR: FARLEY ORG: NMC421 DATE:94-11-22.  <a href="w3fi72_8f.html#aaac6e022f341c919316466672ef3e70c">More...</a><br /></td></tr>
<tr class="separator:aaac6e022f341c919316466672ef3e70c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aaac6e022f341c919316466672ef3e70c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaac6e022f341c919316466672ef3e70c">&#9670;&nbsp;</a></span>w3fi72()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3fi72 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ITYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>FLD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>IFLD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IBITL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IPFLAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character * 1, dimension(*)&#160;</td>
          <td class="paramname"><em>PDS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IGFLAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IGRID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>IGDS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ICOMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IBFLAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>IBMAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IBLEN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*)&#160;</td>
          <td class="paramname"><em>IBDSFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>NPTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character * 1, dimension(*)&#160;</td>
          <td class="paramname"><em>KBUF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ITOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JERR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SUBPROGRAM: W3FI72 MAKE A COMPLETE GRIB MESSAGE PRGMMR: FARLEY ORG: NMC421 DATE:94-11-22. </p>
<p>ABSTRACT: MAKES A COMPLETE GRIB MESSAGE FROM A USER SUPPLIED ARRAY OF FLOATING POINT OR INTEGER DATA. THE USER HAS THE OPTION OF SUPPLYING THE PDS OR AN INTEGER ARRAY THAT WILL BE USED TO CREATE A PDS (WITH W3FI68). THE USER MUST ALSO SUPPLY OTHER NECESSARY INFO; SEE USAGE SECTION BELOW.</p>
<p>PROGRAM HISTORY LOG: 91-05-08 R.E.JONES 92-07-01 M. FARLEY ADDED GDS AND BMS LOGIC. PLACED EXISTING LOGIC FOR BDS IN A ROUTINE. 92-10-02 R.E.JONES ADD ERROR EXIT FOR W3FI73 93-04-30 R.E.JONES REPLACE DO LOOPS TO MOVE CHARACTER DATA WITH XMOVEX, USE XSTORE TO ZERO CHARACTER ARRAY. MAKE CHANGE SO FLAT FIELD WILL PACK. 93-08-06 CAVANAUGH MODIFIED CALL TO W3FI75 93-10-26 CAVANAUGH ADDED CODE TO RESTORE INPUT FIELD TO ORIGINAL VALUES IF D-SCALE NOT 0 94-01-27 CAVANAUGH ADDED IGDS ARRAY IN CALL TO W3FI75 TO PROVIDE INFORMATION FOR BOUSTROPHEDONIC PROCESSING 94-03-03 CAVANAUGH INCREASED SIZE OF GDS ARRAY FOR THIN GRIDS 94-05-16 FARLEY CLEANED UP DOCUMENTATION 94-11-10 FARLEY INCREASED SIZE OF PFLD/IFLD ARRARYS FROM 100K TO 260K FOR .5 DEGREE SST ANAL FIELDS 94-12-04 R.E.JONES CHANGE DOCUMENT FOR IPFLAG. 95-10-31 IREDELL REMOVED SAVES AND PRINTS 98-05-19 Gilbert Increased array dimensions to handle grids of up to 500,000 grid points. 95-10-31 IREDELL GENERALIZED WORD SIZE 98-12-21 Gilbert Replaced Function ICHAR with mova2i. 99-02-01 Gilbert Changed the method of zeroing out array KBUF. the old method, using W3FI01 and XSTORE was incorrect with 4-byte integers and 8-byte reals. 2001-06-07 Gilbert Removed calls to xmovex. changed IPFLD from integer to character. 10-02-19 GAYNO FIX ALLOCATION OF ARRAY BMS</p>
<p>USAGE: CALL W3FI72(ITYPE,FLD,IFLD,IBITL, &amp; IPFLAG,ID,PDS, &amp; IGFLAG,IGRID,IGDS,ICOMP, &amp; IBFLAG,IBMAP,IBLEN,IBDSFL, &amp; IBDSFL, &amp; NPTS,KBUF,ITOT,JERR)</p>
<p>INPUT ARGUMENT LIST: ITYPE - 0 = FLOATING POINT DATA SUPPLIED IN ARRAY 'FLD' 1 = INTEGER DATA SUPPLIED IN ARRAY 'IFLD' FLD - REAL ARRAY OF DATA (AT PROPER GRIDPOINTS) TO BE CONVERTED TO GRIB FORMAT IF ITYPE=0. SEE REMARKS #1 &amp; 2. IFLD - INTEGER ARRAY OF DATA (AT PROPER GRIDPOINTS) TO BE CONVERTED TO GRIB FORMAT IF ITYPE=1. SEE REMARKS #1 &amp; 2. IBITL - 0 = COMPUTER COMPUTES LENGTH FOR PACKING DATA FROM POWER OF 2 (NUMBER OF BITS) BEST FIT OF DATA USING 'VARIABLE' BIT PACKER W3FI58. 8, 12, ETC. COMPUTER RESCALES DATA TO FIT INTO THAT 'FIXED' NUMBER OF BITS USING W3FI59. SEE REMARKS #3.</p>
<p>IPFLAG - 0 = MAKE PDS FROM USER SUPPLIED ARRAY (ID) 1 = USER SUPPLYING PDS NOTE: IF PDS IS GREATER THAN 30, USE IPLFAG=1. THE USER COULD CALL W3FI68 BEFORE HE CALLS W3FI72. THIS WOULD MAKE THE FIRST 30 BYTES OF THE PDS, USER THEN WOULD MAKE BYTES AFTER 30. ID - INTEGER ARRAY OF VALUES THAT W3FI68 WILL USE TO MAKE AN EDITION 1 PDS IF IPFLAG=0. (SEE THE DOCBLOCK FOR W3FI68 FOR LAYOUT OF ARRAY) PDS - CHARACTER ARRAY OF VALUES (VALID PDS SUPPLIED BY USER) IF IPFLAG=1. LENGTH MAY EXCEED 28 BYTES (CONTENTS OF BYTES BEYOND 28 ARE PASSED THROUGH UNCHANGED).</p>
<p>IGFLAG - 0 = MAKE GDS BASED ON 'IGRID' VALUE. 1 = MAKE GDS FROM USER SUPPLIED INFO IN 'IGDS' AND 'IGRID' VALUE. SEE REMARKS #4. IGRID - # = GRID IDENTIFICATION (TABLE B) 255 = IF USER DEFINED GRID; IGDS MUST BE SUPPLIED AND IGFLAG MUST =1. IGDS - INTEGER ARRAY CONTAINING USER GDS INFO (SAME FORMAT AS SUPPLIED BY W3FI71 - SEE DOCKBLOCK FOR LAYOUT) IF IGFLAG=1. ICOMP - RESOLUTION AND COMPONENT FLAG FOR BIT 5 OF GDS(17) 0 = EARTH ORIENTED WINDS 1 = GRID ORIENTED WINDS</p>
<p>IBFLAG - 0 = MAKE BIT MAP FROM USER SUPPLIED DATA </p>
<h1><a class="anchor" id="autotoc_md4"></a>
= BIT MAP PREDEFINED BY CENTER</h1>
<p>SEE REMARKS #5. IBMAP - INTEGER ARRAY CONTAINING BIT MAP IBLEN - LENGTH OF BIT MAP WILL BE USED TO VERIFY LENGTH OF FIELD (ERROR IF IT DOESN'T MATCH).</p>
<p>IBDSFL - INTEGER ARRAY CONTAINING TABLE 11 FLAG INFO BDS OCTET 4: (1) 0 = GRID POINT DATA 1 = SPHERICAL HARMONIC COEFFICIENTS (2) 0 = SIMPLE PACKING 1 = SECOND ORDER PACKING (3) ... SAME VALUE AS 'ITYPE' 0 = ORIGINAL DATA WERE FLOATING POINT VALUES 1 = ORIGINAL DATA WERE INTEGER VALUES (4) 0 = NO ADDITIONAL FLAGS AT OCTET 14 1 = OCTET 14 CONTAINS FLAG BITS 5-12 (5) 0 = RESERVED - ALWAYS SET TO 0 BYTE 6 OPTION 1 NOT AVAILABLE (AS OF 5-16-93) (6) 0 = SINGLE DATUM AT EACH GRID POINT 1 = MATRIX OF VALUES AT EACH GRID POINT BYTE 7 OPTION 0 WITH SECOND ORDER PACKING N/A (AS OF 5-16-93) (7) 0 = NO SECONDARY BIT MAPS 1 = SECONDARY BIT MAPS PRESENT (8) 0 = SECOND ORDER VALUES HAVE CONSTANT WIDTH 1 = SECOND ORDER VALUES HAVE DIFFERENT WIDTHS</p>
<p>OUTPUT ARGUMENT LIST: NPTS - NUMBER OF GRIDPOINTS IN ARRAY FLD OR IFLD KBUF - ENTIRE GRIB MESSAGE ('GRIB' TO '7777') EQUIVALENCE TO INTEGER ARRAY TO MAKE SURE IT IS ON WORD BOUNARY. ITOT - TOTAL LENGTH OF GRIB MESSAGE IN BYTES JERR - = 0, COMPLETED MAKING GRIB FIELD WITHOUT ERROR 1, IPFLAG NOT 0 OR 1 2, IGFLAG NOT 0 OR 1 3, ERROR CONVERTING IEEE F.P. NUMBER TO IBM370 F.P. 4, W3FI71 ERROR/IGRID NOT DEFINED 5, W3FK74 ERROR/GRID REPRESENTATION TYPE NOT VALID 6, GRID TOO LARGE FOR PACKER DIMENSION ARRAYS SEE AUTOMATION DIVISION FOR REVISION! 7, LENGTH OF BIT MAP NOT EQUAL TO SIZE OF FLD/IFLD 8, W3FI73 ERROR, ALL VALUES IN IBMAP ARE ZERO</p>
<p>OUTPUT FILES: FT06F001 - STANDARD FORTRAN OUTPUT PRINT FILE</p>
<p>SUBPROGRAMS CALLED: LIBRARY: W3LIB - W3FI58, W3FI59, W3FI68, W3FI71, W3FI73, W3FI74 W3FI75, W3FI76 FORTRAN 90 INTRINSIC - BIT_SIZE</p>
<p>REMARKS: 1) IF BIT MAP TO BE INCLUDED IN MESSAGE, NULL DATA SHOULD BE INCLUDED IN FLD OR IFLD. THIS ROUTINE WILL TAKE CARE OF 'DISCARDING' ANY NULL DATA BASED ON THE BIT MAP. 2) UNITS MUST BE THOSE IN GRIB DOCUMENTATION: NMC O.N. 388 OR WMO PUBLICATION 306. 3) IN EITHER CASE, INPUT NUMBERS WILL BE MULTIPLIED BY '10 TO THE NTH' POWER FOUND IN ID(25) OR PDS(27-28), THE D-SCALING FACTOR, PRIOR TO BINARY PACKING. 4) ALL NMC PRODUCED GRIB FIELDS WILL HAVE A GRID DEFINITION SECTION INCLUDED IN THE GRIB MESSAGE. ID(6) WILL BE SET TO '1'.</p><ul>
<li>GDS WILL BE BUILT BASED ON GRID NUMBER (IGRID), UNLESS IGFLAG=1 (USER SUPPLYING IGDS). USER MUST STILL SUPPLY IGRID EVEN IF IGDS PROVIDED. 5) IF BIT MAP USED THEN ID(7) OR PDS(8) MUST INDICATE THE PRESENCE OF A BIT MAP. 6) ARRAY KBUF SHOULD BE EQUIVALENCED TO AN INTEGER VALUE OR ARRAY TO MAKE SURE IT IS ON A WORD BOUNDARY. 7) SUBPROGRAM CAN BE CALLED FROM A MULTIPROCESSING ENVIRONMENT.</li>
</ul>
<p>ATTRIBUTES: LANGUAGE: FORTRAN 90 </p>

<p class="definition">Definition at line <a class="el" href="w3fi72_8f_source.html#l00171">171</a> of file <a class="el" href="w3fi72_8f_source.html">w3fi72.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="w3fi72_8f.html">w3fi72.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
